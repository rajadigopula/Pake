name: Build YouTube Adblock
on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: tw93/Pake@main
        with:
          url: "https://www.youtube.com"
          name: "YouTube Adblock"
          inject: |
            // ==UserScript==
            // @name         YouTube Adblock
            // @namespace    http://tampermonkey.net/
            // @version      1.0
            // @description  Block YouTube ads
            // @author       fairy-root
            // @match        *://*.youtube.com/*
            // @icon         https://www.google.com/s2/favicons?sz=64&domain=youtube.com
            // @grant        none
            // ==/UserScript==
            (function() {
                'use strict';
                function blockAds() {
                    const selectors = [
                        '.ad-showing .video-ads',
                        '.ytd-ad-slot-renderer',
                        '.ytd-action-companion-ad-renderer',
                        '.ytd-compact-promoted-video-renderer',
                        '.ytd-promoted-sparkles-web-renderer'
                    ];
                    
                    selectors.forEach(selector => {
                        document.querySelectorAll(selector).forEach(el => {
                            if (el.parentNode) el.parentNode.removeChild(el);
                        });
                    });
                    
                    const videos = document.querySelectorAll('video');
                    videos.forEach(video => {
                        if (video.duration <= 90 && video.currentTime === 0) {
                            video.currentTime = video.duration;
                        }
                    });
                }
                
                setInterval(blockAds, 1000);
                document.addEventListener('DOMContentLoaded', blockAds);
            })();
